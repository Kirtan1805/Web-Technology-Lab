<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Multi-Stage Client-Side Form Workflow Engine</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      color: #333;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #FF6B6B 0%, #4ECDC4 100%);
      color: white;
      padding: 25px;
      text-align: center;
    }

    .header h1 {
      font-size: 28px;
      margin-bottom: 5px;
    }

    .header p {
      opacity: 0.9;
      font-size: 14px;
    }

    .progress-container {
      padding: 20px 30px;
      background: #f8f9fa;
      border-bottom: 1px solid #e1e8ed;
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      background: #e1e8ed;
      border-radius: 6px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(135deg, #FF6B6B 0%, #4ECDC4 100%);
      width: 0%;
      transition: width 0.5s ease;
      border-radius: 6px;
    }

    .progress-steps {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .step {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      flex: 1;
    }

    .step:not(:last-child)::after {
      content: '';
      position: absolute;
      top: 20px;
      left: 50%;
      width: calc(100% - 40px);
      height: 2px;
      background: #e1e8ed;
      z-index: 1;
    }

    .step.completed:not(:last-child)::after {
      background: #4ECDC4;
    }

    .step-circle {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #e1e8ed;
      color: #666;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 8px;
      position: relative;
      z-index: 2;
      transition: all 0.3s ease;
    }

    .step.active .step-circle {
      background: #FF6B6B;
      color: white;
      transform: scale(1.1);
    }

    .step.completed .step-circle {
      background: #4ECDC4;
      color: white;
    }

    .step-label {
      font-size: 12px;
      color: #666;
      text-align: center;
      font-weight: 500;
    }

    .step.active .step-label {
      color: #FF6B6B;
      font-weight: bold;
    }

    .step.completed .step-label {
      color: #4ECDC4;
    }

    .form-container {
      padding: 30px;
      min-height: 500px;
    }

    .stage {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .stage.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .stage-header {
      margin-bottom: 25px;
      text-align: center;
    }

    .stage-title {
      font-size: 24px;
      color: #333;
      margin-bottom: 8px;
    }

    .stage-description {
      color: #666;
      font-size: 16px;
    }

    .form-grid {
      display: grid;
      gap: 20px;
      margin-bottom: 30px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    label {
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
      font-size: 14px;
    }

    .required::after {
      content: " *";
      color: #e74c3c;
    }

    input, select, textarea {
      padding: 12px 15px;
      border: 2px solid #e1e8ed;
      border-radius: 8px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: white;
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #4ECDC4;
      box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.1);
    }

    input.valid, select.valid, textarea.valid {
      border-color: #4ECDC4;
      background: #f8fff9;
    }

    input.invalid, select.invalid, textarea.invalid {
      border-color: #e74c3c;
      background: #fff8f8;
    }

    textarea {
      resize: vertical;
      min-height: 100px;
    }

    .radio-group, .checkbox-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .radio-option, .checkbox-option {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      border: 2px solid #e1e8ed;
      border-radius: 8px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .radio-option:hover, .checkbox-option:hover {
      border-color: #4ECDC4;
      background: #f8fff9;
    }

    .radio-option.selected, .checkbox-option.selected {
      border-color: #4ECDC4;
      background: #f0fff9;
    }

    .radio-option input, .checkbox-option input {
      width: 18px;
      height: 18px;
      margin: 0;
    }

    .radio-option label, .checkbox-option label {
      margin: 0;
      cursor: pointer;
      flex: 1;
      font-weight: normal;
    }

    .rating-group {
      display: grid;
      gap: 15px;
    }

    .rating-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px;
      border: 2px solid #e1e8ed;
      border-radius: 8px;
    }

    .rating-stars {
      display: flex;
      gap: 5px;
    }

    .star {
      width: 24px;
      height: 24px;
      color: #ddd;
      cursor: pointer;
      transition: color 0.2s ease;
    }

    .star.active {
      color: #FFD700;
    }

    .error-message {
      color: #e74c3c;
      font-size: 13px;
      margin-top: 5px;
      display: block;
      font-weight: 500;
    }

    .success-message {
      color: #4ECDC4;
      font-size: 13px;
      margin-top: 5px;
      display: block;
      font-weight: 500;
    }

    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 30px;
      border-top: 1px solid #e1e8ed;
    }

    .nav-btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      min-width: 120px;
    }

    .nav-btn:disabled {
      background: #cccccc !important;
      cursor: not-allowed !important;
      transform: none !important;
      box-shadow: none !important;
    }

    .btn-prev {
      background: #6c757d;
      color: white;
    }

    .btn-prev:hover:not(:disabled) {
      background: #5a6268;
      transform: translateX(-2px);
    }

    .btn-next {
      background: linear-gradient(135deg, #4ECDC4 0%, #45b7aa 100%);
      color: white;
    }

    .btn-next:hover:not(:disabled) {
      transform: translateX(2px);
      box-shadow: 0 5px 15px rgba(78, 205, 196, 0.3);
    }

    .btn-submit {
      background: linear-gradient(135deg, #FF6B6B 0%, #e55a5a 100%);
      color: white;
    }

    .btn-submit:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
    }

    .stage-summary {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }

    .summary-item {
      background: white;
      padding: 15px;
      border-radius: 8px;
      border-left: 4px solid #4ECDC4;
    }

    .summary-label {
      font-weight: bold;
      color: #666;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 5px;
    }

    .summary-value {
      color: #333;
      font-size: 16px;
    }

    .confirmation-group {
      background: #fff3cd;
      border: 1px solid #ffc107;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .confirmation-group h4 {
      color: #856404;
      margin-bottom: 15px;
    }

    .terms-checkbox {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 15px;
      background: white;
      border-radius: 6px;
      border: 2px solid #ffc107;
    }

    .terms-checkbox input {
      margin-top: 2px;
    }

    .terms-checkbox label {
      margin: 0;
      cursor: pointer;
      font-size: 14px;
      line-height: 1.4;
    }

    @media (max-width: 768px) {
      .form-row {
        grid-template-columns: 1fr;
      }

      .progress-steps {
        flex-direction: column;
        gap: 15px;
      }

      .step:not(:last-child)::after {
        display: none;
      }

      .navigation-buttons {
        flex-direction: column;
        gap: 15px;
      }

      .nav-btn {
        width: 100%;
      }

      .summary-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>

<div class="container">
  <div class="header">
    <h1>üìã Multi-Stage Form Workflow Engine</h1>
    <p>Complete validation at each stage with strict navigation control</p>
  </div>

  <!-- Progress Section -->
  <div class="progress-container">
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>
    <div class="progress-steps">
      <div class="step active" id="step1">
        <div class="step-circle">1</div>
        <div class="step-label">Personal Info</div>
      </div>
      <div class="step" id="step2">
        <div class="step-circle">2</div>
        <div class="step-label">Professional</div>
      </div>
      <div class="step" id="step3">
        <div class="step-circle">3</div>
        <div class="step-label">Preferences</div>
      </div>
      <div class="step" id="step4">
        <div class="step-circle">4</div>
        <div class="step-label">Review</div>
      </div>
    </div>
  </div>

  <!-- Form Container -->
  <form id="multiStageForm">
    <div class="form-container">

      <!-- Stage 1: Personal Information -->
      <div class="stage active" id="stage1">
        <div class="stage-header">
          <h2 class="stage-title">üë§ Personal Information</h2>
          <p class="stage-description">Please provide your basic personal details</p>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label for="fullName" class="required">Full Name</label>
            <input type="text" id="fullName" placeholder="Enter your full name">
            <span class="error-message" id="fullNameError"></span>
          </div>

          <div class="form-group">
            <label for="email" class="required">Email Address</label>
            <input type="email" id="email" placeholder="your.email@example.com">
            <span class="error-message" id="emailError"></span>
          </div>

          <div class="form-group">
            <label for="age" class="required">Age</label>
            <input type="number" id="age" placeholder="Enter your age" min="18" max="65">
            <span class="error-message" id="ageError"></span>
          </div>

          <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="tel" id="phone" placeholder="+1 (555) 123-4567">
            <span class="error-message" id="phoneError"></span>
          </div>
        </div>
      </div>

      <!-- Stage 2: Professional Information -->
      <div class="stage" id="stage2">
        <div class="stage-header">
          <h2 class="stage-title">üíº Professional Information</h2>
          <p class="stage-description">Tell us about your professional background</p>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label for="jobTitle" class="required">Current Job Title</label>
            <input type="text" id="jobTitle" placeholder="e.g., Software Developer">
            <span class="error-message" id="jobTitleError"></span>
          </div>

          <div class="form-group">
            <label for="experience" class="required">Years of Experience</label>
            <input type="number" id="experience" placeholder="Years" min="0" max="50">
            <span class="error-message" id="experienceError"></span>
          </div>

          <div class="form-group">
            <label for="education" class="required">Education Level</label>
            <select id="education">
              <option value="">Select education level...</option>
              <option value="high-school">High School</option>
              <option value="associate">Associate Degree</option>
              <option value="bachelor">Bachelor's Degree</option>
              <option value="master">Master's Degree</option>
              <option value="phd">PhD</option>
            </select>
            <span class="error-message" id="educationError"></span>
          </div>
        </div>

        <div class="form-group">
          <label class="required">Technical Skills (select at least 2)</label>
          <div class="checkbox-group" id="skillsGroup">
            <div class="checkbox-option">
              <input type="checkbox" id="skill-js" value="javascript">
              <label for="skill-js">JavaScript</label>
            </div>
            <div class="checkbox-option">
              <input type="checkbox" id="skill-python" value="python">
              <label for="skill-python">Python</label>
            </div>
            <div class="checkbox-option">
              <input type="checkbox" id="skill-java" value="java">
              <label for="skill-java">Java</label>
            </div>
            <div class="checkbox-option">
              <input type="checkbox" id="skill-react" value="react">
              <label for="skill-react">React</label>
            </div>
            <div class="checkbox-option">
              <input type="checkbox" id="skill-node" value="node">
              <label for="skill-node">Node.js</label>
            </div>
            <div class="checkbox-option">
              <input type="checkbox" id="skill-sql" value="sql">
              <label for="skill-sql">SQL</label>
            </div>
          </div>
          <span class="error-message" id="skillsError"></span>
        </div>
      </div>

      <!-- Stage 3: Preferences & Interests -->
      <div class="stage" id="stage3">
        <div class="stage-header">
          <h2 class="stage-title">üéØ Preferences & Interests</h2>
          <p class="stage-description">Help us understand your work preferences</p>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label class="required">Preferred Work Environment</label>
            <div class="radio-group" id="workEnvironmentGroup">
              <div class="radio-option">
                <input type="radio" id="remote" name="workEnvironment" value="remote">
                <label for="remote">üè† Remote Work</label>
              </div>
              <div class="radio-option">
                <input type="radio" id="office" name="workEnvironment" value="office">
                <label for="office">üè¢ Office Based</label>
              </div>
              <div class="radio-option">
                <input type="radio" id="hybrid" name="workEnvironment" value="hybrid">
                <label for="hybrid">üîÑ Hybrid</label>
              </div>
            </div>
            <span class="error-message" id="workEnvironmentError"></span>
          </div>

          <div class="form-group">
            <label for="salaryRange" class="required">Expected Salary Range</label>
            <select id="salaryRange">
              <option value="">Select salary range...</option>
              <option value="30k-50k">$30,000 - $50,000</option>
              <option value="50k-70k">$50,000 - $70,000</option>
              <option value="70k-90k">$70,000 - $90,000</option>
              <option value="90k-120k">$90,000 - $120,000</option>
              <option value="120k+">$120,000+</option>
            </select>
            <span class="error-message" id="salaryRangeError"></span>
          </div>
        </div>

        <div class="form-group">
          <label class="required">Preferred Work Hours</label>
          <div class="radio-group" id="workHoursGroup">
            <div class="radio-option">
              <input type="radio" id="standard" name="workHours" value="standard">
              <label for="standard">üïê Standard 9-5</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="flexible" name="workHours" value="flexible">
              <label for="flexible">üîÑ Flexible Hours</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="shift" name="workHours" value="shift">
              <label for="shift">üåô Shift Work</label>
            </div>
          </div>
          <span class="error-message" id="workHoursError"></span>
        </div>

        <div class="form-group">
          <label>Rate the importance of these benefits (1-5 stars)</label>
          <div class="rating-group">
            <div class="rating-item">
              <span>üí∞ Salary</span>
              <div class="rating-stars" data-rating="salary">
                <span class="star" data-value="1">‚òÖ</span>
                <span class="star" data-value="2">‚òÖ</span>
                <span class="star" data-value="3">‚òÖ</span>
                <span class="star" data-value="4">‚òÖ</span>
                <span class="star" data-value="5">‚òÖ</span>
              </div>
            </div>
            <div class="rating-item">
              <span>üè• Health Insurance</span>
              <div class="rating-stars" data-rating="health">
                <span class="star" data-value="1">‚òÖ</span>
                <span class="star" data-value="2">‚òÖ</span>
                <span class="star" data-value="3">‚òÖ</span>
                <span class="star" data-value="4">‚òÖ</span>
                <span class="star" data-value="5">‚òÖ</span>
              </div>
            </div>
            <div class="rating-item">
              <span>üìö Professional Development</span>
              <div class="rating-stars" data-rating="development">
                <span class="star" data-value="1">‚òÖ</span>
                <span class="star" data-value="2">‚òÖ</span>
                <span class="star" data-value="3">‚òÖ</span>
                <span class="star" data-value="4">‚òÖ</span>
                <span class="star" data-value="5">‚òÖ</span>
              </div>
            </div>
            <div class="rating-item">
              <span>üèñÔ∏è Paid Time Off</span>
              <div class="rating-stars" data-rating="pto">
                <span class="star" data-value="1">‚òÖ</span>
                <span class="star" data-value="2">‚òÖ</span>
                <span class="star" data-value="3">‚òÖ</span>
                <span class="star" data-value="4">‚òÖ</span>
                <span class="star" data-value="5">‚òÖ</span>
              </div>
            </div>
          </div>
          <span class="error-message" id="ratingsError"></span>
        </div>
      </div>

      <!-- Stage 4: Review & Confirmation -->
      <div class="stage" id="stage4">
        <div class="stage-header">
          <h2 class="stage-title">‚úÖ Review & Confirmation</h2>
          <p class="stage-description">Please review your information before submitting</p>
        </div>

        <div class="stage-summary">
          <div class="summary-grid" id="summaryGrid">
            <!-- Summary will be populated dynamically -->
          </div>
        </div>

        <div class="confirmation-group">
          <h4>üìã Final Confirmation</h4>
          <div class="terms-checkbox">
            <input type="checkbox" id="termsAccepted">
            <label for="termsAccepted">
              I confirm that all the information provided is accurate and complete.
              I understand that this information will be used for application processing purposes.
              By submitting this form, I agree to the terms and conditions.
            </label>
          </div>
          <span class="error-message" id="termsError"></span>
        </div>
      </div>

      <!-- Navigation Buttons -->
      <div class="navigation-buttons">
        <button type="button" class="nav-btn btn-prev" id="prevBtn" disabled>
          ‚Üê Previous
        </button>
        <div id="stageIndicator">Stage 1 of 4</div>
        <button type="button" class="nav-btn btn-next" id="nextBtn">
          Next ‚Üí
        </button>
      </div>
    </div>
  </form>
</div>

<script>
  // 1Ô∏è‚É£ Form Data Storage
  let formData = {
    // Stage 1: Personal Information
    fullName: '',
    email: '',
    age: '',
    phone: '',

    // Stage 2: Professional Information
    jobTitle: '',
    experience: '',
    education: '',
    skills: [],

    // Stage 3: Preferences & Interests
    workEnvironment: '',
    salaryRange: '',
    workHours: '',
    ratings: {
      salary: 0,
      health: 0,
      development: 0,
      pto: 0
    },

    // Stage 4: Confirmation
    termsAccepted: false
  };

  // Navigation state
  let currentStage = 1;
  const totalStages = 4;

  // DOM Elements
  const form = document.getElementById('multiStageForm');
  const progressFill = document.getElementById('progressFill');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const stageIndicator = document.getElementById('stageIndicator');

  // 2Ô∏è‚É£ Validation Functions for Each Stage
  function validateStage1() {
    let isValid = true;

    // Full Name validation
    const fullName = document.getElementById('fullName').value.trim();
    if (!fullName) {
      setError('fullName', 'Full name is required');
      isValid = false;
    } else if (fullName.length < 2) {
      setError('fullName', 'Name must be at least 2 characters');
      isValid = false;
    } else if (!/^[a-zA-Z\s]+$/.test(fullName)) {
      setError('fullName', 'Name can only contain letters and spaces');
      isValid = false;
    } else {
      setValid('fullName');
    }

    // Email validation
    const email = document.getElementById('email').value.trim();
    if (!email) {
      setError('email', 'Email is required');
      isValid = false;
    } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
      setError('email', 'Please enter a valid email address');
      isValid = false;
    } else {
      setValid('email');
    }

    // Age validation
    const age = document.getElementById('age').value;
    if (!age) {
      setError('age', 'Age is required');
      isValid = false;
    } else if (age < 18 || age > 65) {
      setError('age', 'Age must be between 18 and 65');
      isValid = false;
    } else {
      setValid('age');
    }

    // Phone validation (optional)
    const phone = document.getElementById('phone').value.trim();
    if (phone && !/^[\+]?[\d\s\-\(\)]{10,}$/.test(phone)) {
      setError('phone', 'Please enter a valid phone number');
      isValid = false;
    } else {
      setValid('phone');
    }

    return isValid;
  }

  function validateStage2() {
    let isValid = true;

    // Job Title validation
    const jobTitle = document.getElementById('jobTitle').value.trim();
    if (!jobTitle) {
      setError('jobTitle', 'Job title is required');
      isValid = false;
    } else if (jobTitle.length < 2) {
      setError('jobTitle', 'Job title must be at least 2 characters');
      isValid = false;
    } else {
      setValid('jobTitle');
    }

    // Experience validation
    const experience = document.getElementById('experience').value;
    if (!experience) {
      setError('experience', 'Years of experience is required');
      isValid = false;
    } else if (experience < 0 || experience > 50) {
      setError('experience', 'Experience must be between 0 and 50 years');
      isValid = false;
    } else {
      setValid('experience');
    }

    // Education validation
    const education = document.getElementById('education').value;
    if (!education) {
      setError('education', 'Education level is required');
      isValid = false;
    } else {
      setValid('education');
    }

    // Skills validation (at least 2)
    const selectedSkills = Array.from(document.querySelectorAll('#skillsGroup input:checked')).map(cb => cb.value);
    if (selectedSkills.length < 2) {
      setError('skills', 'Please select at least 2 technical skills');
      isValid = false;
    } else {
      setValid('skills');
    }

    return isValid;
  }

  function validateStage3() {
    let isValid = true;

    // Work Environment validation
    const workEnvironment = document.querySelector('input[name="workEnvironment"]:checked');
    if (!workEnvironment) {
      setError('workEnvironment', 'Please select your preferred work environment');
      isValid = false;
    } else {
      setValid('workEnvironment');
    }

    // Salary Range validation
    const salaryRange = document.getElementById('salaryRange').value;
    if (!salaryRange) {
      setError('salaryRange', 'Salary range is required');
      isValid = false;
    } else {
      setValid('salaryRange');
    }

    // Work Hours validation
    const workHours = document.querySelector('input[name="workHours"]:checked');
    if (!workHours) {
      setError('workHours', 'Please select your preferred work hours');
      isValid = false;
    } else {
      setValid('workHours');
    }

    // Ratings validation (optional but encouraged)
    const ratings = ['salary', 'health', 'development', 'pto'];
    let hasRatings = false;
    ratings.forEach(rating => {
      const value = getRatingValue(rating);
      if (value > 0) hasRatings = true;
    });

    if (!hasRatings) {
      setError('ratings', 'Please rate at least one benefit category');
      isValid = false;
    } else {
      setValid('ratings');
    }

    return isValid;
  }

  function validateStage4() {
    // Terms acceptance validation
    const termsAccepted = document.getElementById('termsAccepted').checked;
    if (!termsAccepted) {
      setError('terms', 'You must accept the terms and conditions to continue');
      return false;
    } else {
      setValid('terms');
      return true;
    }
  }

  // 3Ô∏è‚É£ Utility Functions for Validation Display
  function setError(fieldId, message) {
    const field = document.getElementById(fieldId);
    const errorElement = document.getElementById(fieldId + 'Error');

    if (field) field.classList.add('invalid');
    if (field) field.classList.remove('valid');
    if (errorElement) errorElement.textContent = message;
  }

  function setValid(fieldId) {
    const field = document.getElementById(fieldId);
    const errorElement = document.getElementById(fieldId + 'Error');

    if (field) field.classList.add('valid');
    if (field) field.classList.remove('invalid');
    if (errorElement) errorElement.textContent = '';
  }

  // 4Ô∏è‚É£ Navigation Control Functions
  function goToNextStage() {
    if (currentStage >= totalStages) return;

    // Validate current stage before proceeding
    if (!validateCurrentStage()) {
      return;
    }

    // Save current stage data
    saveCurrentStageData();

    // Move to next stage
    currentStage++;
    updateStageDisplay();
    updateProgress();
    updateNavigationButtons();
  }

  function goToPreviousStage() {
    if (currentStage <= 1) return;

    currentStage--;
    updateStageDisplay();
    updateProgress();
    updateNavigationButtons();
  }

  function validateCurrentStage() {
    switch (currentStage) {
      case 1: return validateStage1();
      case 2: return validateStage2();
      case 3: return validateStage3();
      case 4: return validateStage4();
      default: return true;
    }
  }

  function saveCurrentStageData() {
    switch (currentStage) {
      case 1:
        formData.fullName = document.getElementById('fullName').value.trim();
        formData.email = document.getElementById('email').value.trim();
        formData.age = document.getElementById('age').value;
        formData.phone = document.getElementById('phone').value.trim();
        break;
      case 2:
        formData.jobTitle = document.getElementById('jobTitle').value.trim();
        formData.experience = document.getElementById('experience').value;
        formData.education = document.getElementById('education').value;
        formData.skills = Array.from(document.querySelectorAll('#skillsGroup input:checked')).map(cb => cb.value);
        break;
      case 3:
        const workEnvironment = document.querySelector('input[name="workEnvironment"]:checked');
        formData.workEnvironment = workEnvironment ? workEnvironment.value : '';

        formData.salaryRange = document.getElementById('salaryRange').value;

        const workHours = document.querySelector('input[name="workHours"]:checked');
        formData.workHours = workHours ? workHours.value : '';

        formData.ratings = {
          salary: getRatingValue('salary'),
          health: getRatingValue('health'),
          development: getRatingValue('development'),
          pto: getRatingValue('pto')
        };
        break;
      case 4:
        formData.termsAccepted = document.getElementById('termsAccepted').checked;
        break;
    }
  }

  // 5Ô∏è‚É£ DOM Manipulation for Stage Management
  function updateStageDisplay() {
    // Hide all stages
    document.querySelectorAll('.stage').forEach(stage => {
      stage.classList.remove('active');
    });

    // Show current stage
    document.getElementById('stage' + currentStage).classList.add('active');

    // Update stage indicator
    stageIndicator.textContent = `Stage ${currentStage} of ${totalStages}`;

    // Update step indicators
    for (let i = 1; i <= totalStages; i++) {
      const step = document.getElementById('step' + i);
      step.classList.remove('active', 'completed');

      if (i === currentStage) {
        step.classList.add('active');
      } else if (i < currentStage) {
        step.classList.add('completed');
      }
    }

    // Update summary if on stage 4
    if (currentStage === 4) {
      updateSummary();
    }
  }

  function updateProgress() {
    const progress = ((currentStage - 1) / (totalStages - 1)) * 100;
    progressFill.style.width = progress + '%';
  }

  function updateNavigationButtons() {
    prevBtn.disabled = currentStage === 1;
    nextBtn.disabled = false;

    // Update next button text for final stage
    if (currentStage === totalStages) {
      nextBtn.textContent = 'üöÄ Submit Form';
      nextBtn.className = 'nav-btn btn-submit';
    } else {
      nextBtn.textContent = 'Next ‚Üí';
      nextBtn.className = 'nav-btn btn-next';
    }
  }

  // 6Ô∏è‚É£ Rating System Functions
  function initializeRatings() {
    document.querySelectorAll('.rating-stars').forEach(ratingGroup => {
      const stars = ratingGroup.querySelectorAll('.star');
      const ratingType = ratingGroup.dataset.rating;

      stars.forEach(star => {
        star.addEventListener('click', () => {
          const value = parseInt(star.dataset.value);
          setRating(ratingType, value);
        });
      });
    });
  }

  function setRating(ratingType, value) {
    const ratingGroup = document.querySelector(`[data-rating="${ratingType}"]`);
    const stars = ratingGroup.querySelectorAll('.star');

    stars.forEach((star, index) => {
      if (index < value) {
        star.classList.add('active');
      } else {
        star.classList.remove('active');
      }
    });
  }

  function getRatingValue(ratingType) {
    const ratingGroup = document.querySelector(`[data-rating="${ratingType}"]`);
    const activeStars = ratingGroup.querySelectorAll('.star.active');
    return activeStars.length;
  }

  // 7Ô∏è‚É£ Summary Generation for Stage 4
  function updateSummary() {
    const summaryGrid = document.getElementById('summaryGrid');

    // Load saved data into form fields for display
    loadStageData(1);
    loadStageData(2);
    loadStageData(3);

    const summaryItems = [
      {
        label: 'Full Name',
        value: formData.fullName || 'Not provided'
      },
      {
        label: 'Email',
        value: formData.email || 'Not provided'
      },
      {
        label: 'Age',
        value: formData.age ? `${formData.age} years` : 'Not provided'
      },
      {
        label: 'Phone',
        value: formData.phone || 'Not provided'
      },
      {
        label: 'Job Title',
        value: formData.jobTitle || 'Not provided'
      },
      {
        label: 'Experience',
        value: formData.experience ? `${formData.experience} years` : 'Not provided'
      },
      {
        label: 'Education',
        value: getEducationLabel(formData.education) || 'Not provided'
      },
      {
        label: 'Skills',
        value: formData.skills.length > 0 ? formData.skills.join(', ') : 'None selected'
      },
      {
        label: 'Work Environment',
        value: getWorkEnvironmentLabel(formData.workEnvironment) || 'Not selected'
      },
      {
        label: 'Salary Range',
        value: formData.salaryRange || 'Not selected'
      },
      {
        label: 'Work Hours',
        value: getWorkHoursLabel(formData.workHours) || 'Not selected'
      },
      {
        label: 'Benefit Ratings',
        value: getRatingsSummary()
      }
    ];

    summaryGrid.innerHTML = summaryItems.map(item => `
      <div class="summary-item">
        <div class="summary-label">${item.label}</div>
        <div class="summary-value">${item.value}</div>
      </div>
    `).join('');
  }

  function getEducationLabel(value) {
    const labels = {
      'high-school': 'High School',
      'associate': 'Associate Degree',
      'bachelor': "Bachelor's Degree",
      'master': "Master's Degree",
      'phd': 'PhD'
    };
    return labels[value];
  }

  function getWorkEnvironmentLabel(value) {
    const labels = {
      'remote': 'Remote Work',
      'office': 'Office Based',
      'hybrid': 'Hybrid'
    };
    return labels[value];
  }

  function getWorkHoursLabel(value) {
    const labels = {
      'standard': 'Standard 9-5',
      'flexible': 'Flexible Hours',
      'shift': 'Shift Work'
    };
    return labels[value];
  }

  function getRatingsSummary() {
    const ratings = formData.ratings;
    const ratedItems = Object.entries(ratings)
      .filter(([key, value]) => value > 0)
      .map(([key, value]) => `${key.charAt(0).toUpperCase() + key.slice(1)}: ${'‚òÖ'.repeat(value)}`)
      .join(', ');

    return ratedItems || 'No ratings provided';
  }

  // 8Ô∏è‚É£ Data Loading for Navigation
  function loadStageData(stage) {
    switch (stage) {
      case 1:
        document.getElementById('fullName').value = formData.fullName;
        document.getElementById('email').value = formData.email;
        document.getElementById('age').value = formData.age;
        document.getElementById('phone').value = formData.phone;
        break;
      case 2:
        document.getElementById('jobTitle').value = formData.jobTitle;
        document.getElementById('experience').value = formData.experience;
        document.getElementById('education').value = formData.education;

        // Load skills checkboxes
        document.querySelectorAll('#skillsGroup input').forEach(cb => {
          cb.checked = formData.skills.includes(cb.value);
        });
        break;
      case 3:
        // Load work environment radio
        if (formData.workEnvironment) {
          document.getElementById(formData.workEnvironment).checked = true;
        }

        document.getElementById('salaryRange').value = formData.salaryRange;

        // Load work hours radio
        if (formData.workHours) {
          document.getElementById(formData.workHours).checked = true;
        }

        // Load ratings
        Object.entries(formData.ratings).forEach(([key, value]) => {
          setRating(key, value);
        });
        break;
    }
  }

  // 9Ô∏è‚É£ Form Submission Handler
  function handleFormSubmission() {
    if (!validateStage4()) {
      return;
    }

    // Save final data
    saveCurrentStageData();

    // Simulate form submission
    const submissionData = {
      ...formData,
      submittedAt: new Date().toISOString(),
      sessionId: Date.now()
    };

    console.log('Form submitted with data:', submissionData);

    // Show success message
    const successMessage = `
      üéâ Registration Successful!

      Thank you for completing the multi-stage form! Your information has been processed.

      Summary of your submission:
      ‚Ä¢ Name: ${formData.fullName}
      ‚Ä¢ Email: ${formData.email}
      ‚Ä¢ Job Title: ${formData.jobTitle}
      ‚Ä¢ Skills: ${formData.skills.join(', ')}
      ‚Ä¢ Work Preference: ${getWorkEnvironmentLabel(formData.workEnvironment)}

      Your application has been received and will be reviewed shortly.
    `;

    alert(successMessage);

    // Reset form
    resetForm();
  }

  function resetForm() {
    form.reset();
    formData = {
      fullName: '', email: '', age: '', phone: '',
      jobTitle: '', experience: '', education: '', skills: [],
      workEnvironment: '', salaryRange: '', workHours: '',
      ratings: { salary: 0, health: 0, development: 0, pto: 0 },
      termsAccepted: false
    };
    currentStage = 1;
    updateStageDisplay();
    updateProgress();
    updateNavigationButtons();

    // Clear all validation states
    document.querySelectorAll('.invalid, .valid').forEach(el => {
      el.classList.remove('invalid', 'valid');
    });
    document.querySelectorAll('.error-message').forEach(el => {
      el.textContent = '';
    });
  }

  // Event Listeners
  nextBtn.addEventListener('click', () => {
    if (currentStage === totalStages) {
      handleFormSubmission();
    } else {
      goToNextStage();
    }
  });

  prevBtn.addEventListener('click', goToPreviousStage);

  // Initialize the form
  initializeRatings();
  updateStageDisplay();
  updateProgress();
  updateNavigationButtons();
</script>

</body>
</html>
